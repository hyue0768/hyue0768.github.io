<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Chiikawa Park 宝宝出场推算</title>
<style>
:root{
  --bg:#f6f7f8;
  --card:#fff;
  --muted:#6b6b6b;
  --accent:#007aff;
  --border:#e9e9ea;
}
body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  background:var(--bg);
  margin:0;
  padding:16px;
  display:flex;
  justify-content:center;
}
.wrap{
  width:100%;
  max-width:480px; /* 移动端最佳宽度 */
}
h1{
  margin:0 0 14px;
  font-size:18px;
  color:#111;
  font-weight:600;
  text-align:center;
}
.card{
  background:var(--card);
  border-radius:14px;
  padding:16px;
  box-shadow:0 6px 18px rgba(0,0,0,0.06);
  border:1px solid rgba(0,0,0,0.03);
}
label{
  font-size:14px;
  color:#333;
  display:block;
  margin-bottom:4px;
}
input[type="time"],select{
  padding:10px;
  border-radius:8px;
  border:1px solid var(--border);
  background:transparent;
  font-size:16px;
  outline:none;
  width:100%;
  box-sizing:border-box;
}
button{
  margin-top:16px;
  padding:12px;
  border-radius:10px;
  background:var(--accent);
  color:#fff;
  border:none;
  cursor:pointer;
  font-weight:600;
  width:100%;
  font-size:16px;
}
button:hover{background:#0066d6;}
.info{margin-top:12px;color:var(--muted);font-size:14px;}
.tables{
  margin-top:18px;
  display:grid;
  grid-template-columns:1fr;
  gap:14px;
}
table{
  width:100%;
  border-collapse:collapse;
  background:#fff;
  border-radius:10px;
  box-shadow:0 2px 8px rgba(0,0,0,0.03);
  overflow:auto;
  display:block;
}
thead th{
  text-align:center;
  padding:10px 8px;
  font-size:14px;
  background:#fbfbfb;
  border-bottom:1px solid var(--border);
  color:#333;
}
tbody td{
  padding:10px 8px;
  font-size:14px;
  border-bottom:1px solid var(--border);
  text-align:center;
  color:#111;
}
.small{
  font-size:12px;
  color:var(--muted);
  margin-top:8px;
  text-align:center;
}
@media(max-width:480px){
  .wrap{padding:0 12px;}
}
</style>
</head>
<body>
<div class="wrap">
  <h1>Chiikawa Park 宝宝出场推算</h1>
  <div class="card">
    <div style="display:grid;gap:12px;">
      <div>
        <label>当前时间（自动定位20分钟段）</label>
        <input id="time" type="time" value="13:00" />
      </div>
      <div>
        <label>当前左/右角色（两者不同）</label>
        <div style="display:flex;gap:8px;margin-top:4px;">
          <select id="left">
            <option>小八</option><option>吉伊</option><option>飞鼠</option><option>乌萨奇</option>
          </select>
          <select id="right">
            <option>小八</option><option>吉伊</option><option>飞鼠</option><option>乌萨奇</option>
          </select>
        </div>
      </div>
    </div>

    <button id="genBtn">生成时间推算表</button>
    <div id="out" class="info"></div>
    <div id="tables" class="tables" style="display:none;"></div>
    <div class="small">提示：仅显示从当前时段开始往后的推算（20分钟为单位，直到20:00）。</div>
    <div class="small">提示：此处左右方向为自己面对的方向，离检票入场近的是右侧，离内场出口近的是左侧</div>
  </div>
</div>

<script>
// JS 代码保持原样
const ALL = ["小八","吉伊","飞鼠","乌萨奇"];
function mod(n,m){return((n%m)+m)%m;}
function clampToSlot(timeStr){
  if(!timeStr)return null;
  const [h,m]=timeStr.split(':').map(Number);
  const minutes=h*60+m;
  const start=10*60,end=20*60;
  if(minutes<start||minutes>=end)return null;
  return Math.floor((minutes-start)/20);
}
function buildSlots(){
  const arr=[];let cur=new Date();cur.setHours(10,0,0,0);
  const end=new Date();end.setHours(20,0,0,0);
  while(cur<end){
    const h=String(cur.getHours()).padStart(2,'0');
    const m=String(cur.getMinutes()).padStart(2,'0');
    const s=`${h}:${m}`;
    const n=new Date(cur.getTime()+20*60000);
    const nh=String(n.getHours()).padStart(2,'0');
    const nm=String(n.getMinutes()).padStart(2,'0');
    arr.push({start:s,end:`${nh}:${nm}`});
    cur=n;
  }
  return arr;
}
function makeCycle(slotIdx,left,right,order){
  const cycle=new Array(4).fill(null);
  const posR=mod(slotIdx,4);
  const posL=mod(slotIdx-1,4);
  cycle[posR]=right;cycle[posL]=left;
  const rem=[0,1,2,3].filter(i=>!cycle[i]);
  cycle[rem[0]]=order[0];cycle[rem[1]]=order[1];
  return cycle;
}
function renderTable(cycle,slots,startIdx){
  const tbl=document.createElement('table');
  tbl.innerHTML=`<thead><tr><th>时间段</th><th>左侧</th><th>右侧</th></tr></thead>`;
  const body=document.createElement('tbody');
  for(let i=startIdx;i<slots.length;i++){
    const left=cycle[mod(i-1,4)];
    const right=cycle[mod(i,4)];
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${slots[i].start} - ${slots[i].end}</td><td>${left}</td><td>${right}</td>`;
    body.appendChild(tr);
  }
  tbl.appendChild(body);
  return tbl;
}
document.getElementById('genBtn').addEventListener('click',()=>{
  const t=document.getElementById('time').value;
  const L=document.getElementById('left').value;
  const R=document.getElementById('right').value;
  const out=document.getElementById('out');
  const wrap=document.getElementById('tables');
  wrap.style.display='none';wrap.innerHTML='';
  if(!t){out.innerHTML='<span style="color:#c00">请输入时间。</span>';return;}
  const idx=clampToSlot(t);
  if(idx===null){out.innerHTML='<span style="color:#c00">时间需在10:00~20:00之间。</span>';return;}
  if(L===R){out.innerHTML='<span style="color:#c00">左右角色不能相同。</span>';return;}
  const remain=ALL.filter(r=>r!==L&&r!==R);
  const slots=buildSlots();
  const cyc1=makeCycle(idx,L,R,[remain[0],remain[1]]);
  const cyc2=makeCycle(idx,L,R,[remain[1],remain[0]]);
  const table1=renderTable(cyc1,slots,idx);
  const table2=renderTable(cyc2,slots,idx);
  const box1=document.createElement('div');
  const box2=document.createElement('div');
  box1.append(table1);box2.append(table2);
  wrap.append(box1);wrap.append(box2);
  wrap.style.display='grid';
  out.innerHTML=`当前时间 <b>${t}</b> 位于 <b>${slots[idx].start}–${slots[idx].end}</b> 段，仅显示该段及之后的推算。`;
});
</script>
</body>
</html>